
\usepackage{xspace}
\usepackage{xifthen}

\newenvironment{lessspace}%
{\setlength{\abovedisplayskip}{3pt}\setlength{\belowdisplayskip}{3pt}}
{}

% \setlength{\abovedisplayskip}{5pt}%
% \setlength{\belowdisplayskip}{5pt}%
\newenvironment{myalign*}{\begin{align*}}{\end{align*}}


\makeatletter
\def\blfootnote{\xdef\@thefnmark{}\@footnotetext}
\makeatother


\newcommand{\binfunc}[3]{
\[ \ensuremath{#1} = 
\begin{cases}
1 & \ensuremath{#2}\\
0 & \ifthenelse{\isempty{#3}}{\text{otherwise}}{\ensuremath{#3}}
\end{cases}
\]
}

\newcommand{\myint}[2]{\int\ensuremath{#1}\mathrm{d}{\ensuremath{#2}}}

\newcommand{\mylint}[4]{\int\limits_{\ensuremath{#1}}^{\ensuremath{#2}} \ensuremath{#3}\mathrm{d}{\ensuremath{#4}}}

\newcommand{\expec}[2]{\ensuremath{\angbrack{\ensuremath{#1}}_{\ensuremath{#2}}}}
\newcommand{\sexpec}[1]{\angbrack{\ensuremath{#1}}}

\newcommand{\mydera}[2]{\ensuremath{\frac{\partial\ensuremath{#1}}{\partial \ensuremath{#2}}}}

\newcommand{\myderb}[2]{\ensuremath{\frac{\partial}{\partial \ensuremath{#2}}\ensuremath{#1}}}


%\everymath{\displaystyle}

%language acronyms
\newcommand{\pt}{\texttt{pt}\xspace}
\newcommand{\en}{\texttt{en}\xspace}
\newcommand{\es}{\texttt{es}\xspace}
\newcommand{\fr}{\texttt{fr}\xspace}
\newcommand{\de}{\texttt{de}\xspace}
\newcommand{\entoes}{\texttt{en-es}\xspace}
\newcommand{\entode}{\texttt{en-de}\xspace}

%latin acronyms
\newcommand{\ie}{i.e.\xspace}
\newcommand{\eg}{e.g.\xspace}
\newcommand{\wrt}{w.r.t.\xspace}


% new commands
\newcommand{\brackit}[2]{$_[$#2$_{]_{\text{#1}}}$}
\newcommand{\brackitupdown}[3]{$_[$#3$_{]_{\text{#1}}^{\text{#2}}}$}
\newcommand{\roleitupdown}[4]{$_{[_{\text{#1}}}$#4$_{]_{\text{#2}}^{\text{#3}}}$}
\newcommand{\indice}[1]{$_{#1}$}
\newcommand{\upindice}[1]{$^{#1}$}
\newcommand{\updownindice}[2]{$^{#1}_{#2}$}
\newcommand{\role}[2]{$_{[_{\text{#1}}}$#2$_]$}

\newcommand{\analysis}[1]{\texttt{#1}\xspace}
\newcommand{\textfrac}[2]{$\frac{\text{#1}}{\text{#2}}$}

\newcommand{\rfig}[1]{Figure \ref{fig:#1}\xspace}
\newcommand{\ralg}[1]{Algorithm \ref{alg:#1}\xspace}
\newcommand{\rtab}[1]{Table \ref{tab:#1}\xspace}
\newcommand{\rsec}[1]{\S \ref{sec:#1}\xspace}
\newcommand{\req}[1]{Equation \ref{eq:#1}\xspace}
\newcommand{\reqb}[1]{(\ref{eq:#1})\xspace}
\newcommand{\rch}[1]{Chapter \ref{cha:#1}\xspace}


% TEXT HELPER
\newcommand{\precite}[1]{{\color{red}(?#1?)}}
\newcommand{\fixme}[1]{{\color{red} [$_{FIXME}$} {\em #1} {\color{red}]}}
\newcommand{\elaborate}[1]{{\color{blue} [$_{ELABORATE}$} {\em #1} {\color{blue}]}}
\newcommand{\todo}[1]{\footnote{{\bf \color{red} TODO:} {\em #1} }}

% Dyer's stuff
\newcommand{\wset}[1]{\ensuremath{#1}}
\newcommand{\wrel}[1]{\ensuremath{\mathcal{#1}}}
\newcommand{\angbrack}[1]{\ensuremath{\left\langle #1 \right\rangle}}
\newcommand{\nobrack}[1]{\ensuremath{#1}}
\newcommand{\itembrack}[1]{\ensuremath{\left[ #1 \right]}}
\newcommand{\rulebrack}[1]{\ensuremath{\angbrack{#1}}}
\newcommand{\rhs}[1]{\ensuremath{\text{RHS}[#1]}}
\newcommand{\lhs}[1]{\ensuremath{\text{LHS}[#1]}}
\newcommand{\rhsi}[1]{\ensuremath{\text{RHS}_i[#1]}}
\newcommand{\rhso}[1]{\ensuremath{\text{RHS}_o[#1]}}
\newcommand{\gaps}{\ensuremath{\{\scriptsize{\boxed{1}}, \scriptsize{\boxed{2}}, \ldots\}}}
\newcommand{\gapone}{\ensuremath{\{\scriptsize{\boxed{1}}\}}}
\newcommand{\gap}[1]{\ensuremath{\scriptsize{\boxed{#1}}}}

\newcommand{\ralign}[1]{\multicolumn{1}{|r|}{#1}}




\newcommand{\opa}{\ensuremath{\text{a}}}
\newcommand{\opb}{\ensuremath{\text{b}}}
\newcommand{\opbi}{\ensuremath{\text{b}_x}}
\newcommand{\opbo}{\ensuremath{\text{b}_y}}
\newcommand{\opc}{\ensuremath{\text{c}}}
\newcommand{\opd}{\ensuremath{\text{d}}}
\newcommand{\oph}{\ensuremath{\text{h}}}
\newcommand{\opl}{\ensuremath{\text{l}}}
\newcommand{\ops}{\ensuremath{\text{s}}}
\newcommand{\opn}{\ensuremath{\text{n}}}
\newcommand{\opi}{\ensuremath{\text{i}}}
\newcommand{\opo}{\ensuremath{\text{o}}}
\newcommand{\opt}{\ensuremath{\text{t}}}
\newcommand{\opx}{\ensuremath{\text{x}}}
\newcommand{\opy}{\ensuremath{\text{y}}}
\newcommand{\opv}{\ensuremath{\text{v}}}

\newcommand{\boldu}{\ensuremath{\mathbf{u}}}
\newcommand{\boldv}{\ensuremath{\mathbf{v}}}




\newcommand{\mC}{\ensuremath{C}\xspace}
\newcommand{\mA}{\ensuremath{A}\xspace}
\newcommand{\mAA}{\ensuremath{\mathcal{\mA}}\xspace}

\newcommand{\mG}{\ensuremath{G}\xspace}

\newcommand{\mGG}{\ensuremath{\mathcal{\mG}}\xspace}


\newcommand{\pref}{\ensuremath{P}\xspace}
\newcommand{\suff}{\ensuremath{z}\xspace}
\newcommand{\hist}{\ensuremath{h}\xspace}
\newcommand{\prefsuff}{\ensuremath{\pref\suff}\xspace}
\newcommand{\NOT}{{\bf not}\xspace}

\newcommand{\mFGA}{\ensuremath{\mFF \circ \mGG \circ \mAA}\xspace}

%\newcommand{\mH}{\ensuremath{\mG(\mf)}\xspace}
%\newcommand{\mHa}{\ensuremath{\mG_a(\mf)}\xspace}
\newcommand{\mGf}{\ensuremath{\mG(\mxx)}\xspace}
\newcommand{\mRf}{\ensuremath{\mG'(\mf)}\xspace}
\newcommand{\mGA}{\ensuremath{\mG_{\inter \mA}}\xspace}
%\newcommand{\mHA}{\mGA}
\newcommand{\mX}{\ensuremath{X}\xspace}
\newcommand{\mXX}{\ensuremath{\mathcal{\mX}}\xspace}

\newcommand{\winter}[2]{\ensuremath{\langle #1, #2 \rangle}\xspace}
\newcommand{\semiring}[1]{\ensuremath{\mathbb{#1}}\xspace}

\newcommand{\bzero}{\ensuremath{\bar{0}}\xspace}
\newcommand{\bone}{\ensuremath{\bar{1}}\xspace}
\newcommand{\bos}{\text{\scriptsize BOS}\xspace}
\newcommand{\eos}{\text{\scriptsize EOS}\xspace}


\newcommand{\ant}[3]{\ensuremath{\xspace\tensor[_{#1}]{{#2}}{_{#3}}}\xspace}

\newcommand{\xt}[1]{\ensuremath{x^{(#1)}}\xspace}
\newcommand{\ti}[2]{\ensuremath{{#1}^{#2}}\xspace}
\newcommand{\ix}[1]{\ti{x}{#1}}
\newcommand{\iz}[1]{\ti{z}{#1}}
\newcommand{\qt}[1]{\ensuremath{q^{(#1)}}\xspace}
\newcommand{\gt}[1]{\ensuremath{g^{(#1)}}\xspace}
\newcommand{\Gt}[1]{\ensuremath{G^{(#1)}}\xspace}
\newcommand{\Ht}[1]{\ensuremath{G^{(#1)}(f)}\xspace}
\newcommand{\At}[1]{\ensuremath{\mA^{(#1)}}\xspace}
\newcommand{\Ct}[1]{\ensuremath{\mC^{(#1)}}\xspace}
\newcommand{\CCt}[1]{\ensuremath{\bar{\mC}^{(#1)}}\xspace}
\newcommand{\Att}[1]{\ensuremath{\mA^{#1}_{0}}\xspace}

\newcommand{\union}{\ensuremath{\cup}\xspace}
\newcommand{\inter}{\ensuremath{\cap}\xspace}
\newcommand{\norm}[1]{\|#1\|}
\newcommand{\la}{\ensuremath{\leftarrow}\xspace}
\newcommand{\ra}{\ensuremath{\rightarrow}\xspace}
\newcommand{\ara}[1]{\ensuremath{\xrightarrow[]{#1}}\xspace}
\newcommand{\xra}[1]{\ensuremath{\xrightarrow[#1]{ }}\xspace}
\newcommand{\nura}[1]{\ensuremath{\xrightarrow[\nu_{#1}]{ }}\xspace}
\newcommand{\drule}[3]{\dfrac{#1}{#2} ~~ #3}
\newcommand{\bul}{{\,\bullet\,}}
%\newcommand{\argmax}{\arg\max}
\DeclareMathOperator*{\argmax}{\arg\!\max}
%\newcommand{\argmin}{\arg\min}
\DeclareMathOperator*{\argmin}{\arg\!\min}
\DeclareMathOperator{\ltrim}{ltrim}
\DeclareMathOperator{\rtrim}{rtrim}
\DeclareMathOperator{\tail}{tail}
\DeclareMathOperator{\search}{search}
\DeclareMathOperator{\refine}{refine}
\DeclareMathOperator{\replace}{replace}
\DeclareMathOperator{\loss}{loss}
\DeclareMathOperator{\gain}{gain}
\DeclareMathOperator{\bleu}{BLEU}
\DeclareMathOperator{\yield}{yield}


%\newcommand{\ii}[3]{\ensuremath{\,_{#1}{#2}_{#3}\xspace}}
\newcommand{\ii}[3]{\ensuremath{\xspace\tensor[_{#1}]{{#2}}{_{#3}}}\xspace}
\newcommand{\escan}[3]{\ensuremath{\xspace\tensor[_{#1}]{{S^#2}}{_{#3}}}\xspace}
\newcommand{\ecomp}[3]{\ensuremath{\xspace\tensor[_{#1}]{{C^#2}}{_{#3}}}\xspace}
\newcommand{\epred}[2]{\ensuremath{\xspace\tensor[_{#1}]{{P^#2}}{}}\xspace}

\newcommand{\true}{\ensuremath{\text{true}}}
\newcommand{\false}{\ensuremath{\text{false}}}

\newcommand{\uhigh}{\ensuremath{^{\text{\tiny high}}}}
\newcommand{\ulow}{\ensuremath{^{\text{\tiny low}}}}

\newcommand{\cellg}{\cellcolor{gray}}
\newcommand{\celldg}{\cellcolor{darkgray}}
\newcommand{\cellb}{\cellcolor{black}}


\newcommand{\insidesym}{\ensuremath{\mathsf{I}}}
\newcommand{\outsidesym}{\ensuremath{\mathsf{O}}}
\newcommand{\marginalsym}{\ensuremath{\mathsf{M}}}
\newcommand{\inside}[1]{\ensuremath{\mathsf{I}[#1]}}
\newcommand{\outside}[1]{\ensuremath{\mathsf{O}[#1]}}
\newcommand{\marginal}[1]{\ensuremath{\mathsf{M}[#1]}}
\newcommand{\normmarginal}[1]{\ensuremath{\bar{\mathsf{M}}[#1]}}



\newcommand{\wdlca}{
%\left\{
\begin{array}{l}
m = i' - i \leq d \\ 
F = 1^m0^(d-m) \\
C \wedge F = 0^d \\
\alpha_1(F) = i'' - i \\
\end{array}
%\right.
}

\newcommand{\wdlcb}{
%\left\{
\begin{array}{l}
i'' - i \leq d
m = i'' - i' + 1\\ 
p = i' - i - 1 \\
F = 0^p1^m0^{d-p-m} \\
C \wedge F = 0^d \\
\end{array}
%\right.
}


%\newcommand{\lowacl}[1]{\MakeLowercase{\protect\acl{#1}}}

%% insertions made by Marc
% color these insertions
\newcommand{\mdi}[1]{\textcolor{blue}{#1}}
% remove the coloring:
% \newcommand{\mdi}[1]{{#1}}


%%%%% LEARNING

\newcommand{\uZy}{\expec{\gamma_\myy(\mdd)\unr(\mdd)}{q}}
\newcommand{\uZ}{\expec{\unr(\mdd)}{q}}
\newcommand{\uFy}{\expec{\gamma_\myy(\mdd)\mff(\mdd)\unr(\mdd)}{q}}
\newcommand{\uF}{\expec{\mff(\mdd)\unr(\mdd)}{q}}
\newcommand{\uGy}{\expec{\gamma_\myy(\mdd)\mgg(\mdd)\unr(\mdd)}{q}}
\newcommand{\uG}{\expec{\mgg(\mdd)\unr(\mdd)}{q}}
\newcommand{\py}{\ensuremath{\frac{\uZy}{\uZ}}}


\newcommand{\sZy}{\ensuremath{\sum_{i=1}^N \gamma_\myy(\mdd_i)\unr(\mdd_i)}}
\newcommand{\sZ}{\ensuremath{\sum_{i=1}^N \unr(\mdd_i)}}
\newcommand{\sFy}{\ensuremath{\sum_{i=1}^N \gamma_\myy(\mdd_i)\mff(\mdd_i)\unr(\mdd_i)}}
\newcommand{\sF}{\ensuremath{\sum_{i=1}^N \mff(\mdd_i)\unr(\mdd_i)}}
\newcommand{\sGy}{\ensuremath{\sum_{i=1}^N \gamma_\myy(\mdd_i)\mgg(\mdd_i)\unr(\mdd_i)}}
\newcommand{\sG}{\ensuremath{\sum_{i=1}^N \mgg(\mdd_i)\unr(\mdd_i)}}
\newcommand{\spy}{\ensuremath{\frac{\sZy}{\sZ}}}