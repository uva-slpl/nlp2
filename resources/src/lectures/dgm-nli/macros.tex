% Custom macros
\newcommand{\angbrack}[1]{\ensuremath{\langle #1 \rangle}}
\newcommand{\cc}[1]{$\dagger$\marginpar{\fbox{\parbox{19mm}{\scriptsize #1}}}}
\interfootnotelinepenalty=10000
\newcommand{\reftab}[1]{Table~\ref{tab:#1}}
\newcommand{\refeq}[1]{Equation~\ref{eq:#1}}
\newcommand{\reffig}[1]{Figure~\ref{fig:#1}}
\newcommand{\refalg}[1]{Algorithm~\ref{alg:#1}}
\newcommand{\refsec}[1]{Section~\ref{sec:#1}}
\newcommand{\dx}{\ensuremath{{d_{\texttt{x}}}}}
\newcommand{\dhidden}{\ensuremath{{d_{\texttt{h}}}}}
%\newcommand{\dw}{\ensuremath{{d_{\texttt{\omega}}}}}
\newcommand{\ds}{\ensuremath{{d_{\texttt{s}}}}}
\newcommand{\vx}{\ensuremath{{v_{\texttt{x}}}}}
\newcommand{\vy}{\ensuremath{{v_{\texttt{y}}}}}
\newcommand{\txt}[1]{{\ensuremath{\text{#1}}}}
\DeclareMathOperator{\KL}{KL}
\DeclareMathOperator{\R}{R}
\DeclareMathOperator{\vMF}{vMF}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\Cat}{Cat}
\DeclareMathOperator{\Ray}{Rayleigh}
\DeclareMathOperator{\Bern}{Bern}
\DeclareMathOperator{\Beta}{Beta}
\DeclareMathOperator{\ELBO}{ELBO}
\DeclareMathOperator{\encode}{encode}
\DeclareMathOperator{\MLP}{MLP}
\DeclareMathOperator{\softmax}{softmax}
\DeclareMathOperator{\softplus}{softplus}
\DeclareMathOperator{\sigmoid}{sigmoid}
\DeclareMathOperator{\onehot}{one-hot}
\DeclareMathOperator{\emb}{emb}
\DeclareMathOperator{\rnn}{rnn}
\DeclareMathOperator{\birnn}{birnn}
\DeclareMathOperator{\loc}{location}
\DeclareMathOperator{\scale}{scale}
\DeclareMathOperator{\att}{attention}
\DeclareMathOperator{\affine}{affine}
\DeclareMathOperator{\concat}{concat}
\DeclareMathOperator{\compose}{compose}
\DeclareMathOperator{\avg}{avg}
\DeclareMathOperator{\maxpool}{maxpool}
\DeclareMathOperator{\mlp}{mlp}
\DeclareMathOperator{\layer}{layer}
\DeclareMathOperator{\gauss}{gauss}
\DeclareMathOperator{\spherical}{vmf}
\DeclareMathOperator{\relu}{ReLu}
\DeclareMathOperator{\css}{css}
\newcommand{\Lx}{\texttt{L1}\xspace}
\newcommand{\Ly}{\texttt{L2}\xspace}

\newcommand{\inv}[1]{{#1}^{-1}}
\newcommand{\jac}[2]{J_{#1}(#2)}
\newcommand{\djac}[2]{\left| \det \jac{#1}{#2} \right|}
\DeclareMathOperator*{\argmax}{arg\,max}